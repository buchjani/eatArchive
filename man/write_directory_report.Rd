% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/write_directory_report.R
\name{write_directory_report}
\alias{write_directory_report}
\title{Create an Excel workbook with metadata for all subfolders of a directory}
\usage{
write_directory_report(
  dir,
  output_file,
  exclude_folders = "_Archive",
  autocomplete_values = NA
)
}
\arguments{
\item{dir}{Character. Path to the directory whose immediate subfolders should be scanned.}

\item{output_file}{Character. Path to the Excel file to be written (e.g., "metadata.xlsx").}

\item{exclude_folders}{Character vector. Names of subfolders to exclude from processing.}

\item{autocomplete_values}{Optional. Controls whether and how the "Archive" column is included and pre-filled:
\itemize{
\item If \code{NULL}, the "Archive" column is not included.
\item If \code{NA}, a column "Archive" is included but autocomplete and filtering in Excel will not be available.
\item If a character vector is provided, the values are added to enable autocomplete and filtering in Excel,
making it easier to assign target folders for file archiving.
}}
}
\value{
Invisibly returns the path to the written Excel file.
}
\description{
Scans each immediate subfolder of the specified directory (excluding any listed in \code{exclude_folders})
and writes an Excel file containing file-level metadata. Each subfolder gets its own sheet, listing
all files (recursively) with their name, size, and last modified timestamp.\cr \cr
Optionally, an additional column named "Archive" is included in each sheet. The values of "Archive"
will later be used by \code{create_archive()} to indicate the destination folder for copying or converting files.
}
\details{
The Excel workbook includes:
\itemize{
\item One sheet per immediate subfolder of the specified directory
\item Each sheet contains a recursive listing of all files in that subfolder (including sub-subfolders)
\item Optional autocomplete rows inserted directly below the header (e.g., for manual annotation)
\item Column widths and light styling for improved readability
}

Files located in any subfolder whose name matches one of the entries in
\code{exclude_folders} will be excluded entirely (i.e., they are not scanned or listed).

This function is intended as part of a file management workflow in which files may later be
reviewed, copied, or converted based on the generated metadata file.
}
\examples{
\dontrun{
# Write metadata for all subfolders of "my_project/"
write_directory_report("my_project/", "metadata_summary.xlsx")

# Include an autocomplete row with names of archival folders
write_directory_report("my_project/", "summary.xlsx", autocomplete_values = c("contracts", "data"))

# Include all subfolders (do not exclude any)
write_directory_report("my_project/", "summary.xlsx", exclude_folders = NULL)
}

}
\seealso{
\code{\link[openxlsx]{createWorkbook}}, \code{\link[fs]{dir_ls}}, \code{\link[base]{file.info}}
}
